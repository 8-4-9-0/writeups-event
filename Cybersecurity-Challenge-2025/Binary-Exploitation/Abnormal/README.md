## Abnormal (295pt / 42 solves) [★☆☆☆]
> Flag を売っているショップを見つけた! けど所持金が足りない...どうしよう?  
> 伝説の剣を売ればなんとかなるかな??
>
>
> 本問題のターゲットマシンを起動してください。起動が完了したら、VPN接続マシンまたはBrowser Kaliから `nc <ターゲットのIP> 8101` コマンドで接続してください。
>
>
> 添付ファイル: abnormal.zip
> 
> ZIPのハッシュ値(SHA256): `10788346430ab2cb1590a34a2d9fc6828b0cb986f32a55990e304d85d57df923`
> 
>
> ヒント
> - ダウンロードできる問題ファイルにはダミーフラグが含まれています。一方で、本物のフラグはDEPLOYされた環境にのみ存在します。本物のフラグを確認するには、DEPLOYした環境でどのような操作を行えばよいか考えてみましょう。
> - 整数オーバーフローで検索してみましょう。

問題鯖に接続、あるいは配布されているバイナリ（ソースコード無し）を起動すると次のような画面が現れる。
```
=================================================
      _____ _ _       _____ _
     |  ___| (_)_ __ |  ___| | ___  _ __
     | |_  | | | '_ \| |_  | |/ _ \| '_ \
     |  _| | | | |_) |  _| | | (_) | |_) |
     |_|   |_|_| .__/|_|   |_|\___/| .__/
               |_|                 |_|

           Welcome to Flip-Flop Shop!
=================================================


+================= Player Status =================+
| 💰 Gold: 1000                                  |
|                                                |
| 🎒 Inventory:                                  |
|   - Herb            x 100                      |
|   - Legendary Sword x 1                        |
+================================================+
Choose an action:
 1. Buy
 2. Sell
 3. Exit

>
```

BuyではTorch（10円）、Holy Water（20円）、Great Stone（800円）、FLAG（9999999円）を買うことができ、SellではInventoryにあるものを売り払うことができる（Herbは10円で、Legendary Swordは220000円）。  
目標はFLAGを購入することだが、手持ちのゴールドとInventoryにあるものを売っても全然足りない。ではどうするのかというと、売る個数を入力する場面で負の数を入力することが出来てしまうので、負のオーバーフローを起こして不当に大金持ちになれば良い。    
```
+================= Player Status =================+
| 💰 Gold: 741748296                             |
|                                                |
| 🎒 Inventory:                                  |
|   - Herb            x 100                      |
|   - Legendary Sword x 1                        |
+================================================+
Choose an action:
 1. Buy
 2. Sell
 3. Exit

> 1

=== 🛍️ What would you like to buy? ===
 1. Torch - 10 yen
 2. Holy Water - 20 yen
 3. Great Stone - 800 yen
 4. FLAG - 9999999 yen 

Select an item to buy: 4
🎉 Congratulations! Here is your flag:
flag{Th3_m1nu5_cr33p5_b3y0nd_ch405}
```

### `flag{Th3_m1nu5_cr33p5_b3y0nd_ch405}`