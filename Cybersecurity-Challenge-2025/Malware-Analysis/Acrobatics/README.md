## Acrobatics (320pt / 37 solves) [★★☆☆]
> あなたは社内のセキュリティチームの一員として、従業員から送られてきた「怪しいPDFファイル」の調査を任されました。  
> 一見普通の書類に見えますが、何か仕掛けがあるようです。
> 
> 
> 添付ファイル: Acrobatics.zip
> 
> ZIPのパスワード: `CybersecurityChallenge`
> 
> ZIPのハッシュ値(SHA256): `56e16d8dc99f407c98c95b9f344b8df2525581738873093516414a26e8b0ac82`
> 
> ※このファイルには実行コードが含まれていますが、危険なコードではありません。
> 
> 
> ヒント
> - 特定のPDFビューワによっては、何かが表示されるかもしれません。
> - フラグは何かのアルゴリズムでエンコードされています

危険なコードではないとはいえそのまま開くのは少しためらわれたので、バイナリエディタで中身を覗いてみる。するとファイルの末尾辺りに明らかに怪しげなオブジェクトがある。
```
obj
<<
/Type /Action
/S /JavaScript
/JS (var\040\137d\040\075\040\13389\054111\054117\054114\05432\054102\054108\05497\054103\05432\054105\054115\05458\05432\054\040\04090\054109\054120\054104\05490\05451\054116\054119\05490\05471\05490\054102\05497\054109\054\040\04070\05450\05489\05488\05478\054106\05499\054109\054108\054119\054100\05470\05457\054116\054\040\04089\05487\054100\054112\05489\05451\05448\05461\135\073app\056alert\050String\056fromCharCode\056apply\050null\054\040\137d\051\051\073)
>>
endobj
```

`()`で囲まれている部分についてLLMにデコードをお願いすると、以下のJavascriptが現れた。ちなみに8進数エンコードらしい。
```
var _d = [89, 111, 117, 114, 32, 102, 108, 97, 103, 32, 105, 115, 58, 32,  90, 109, 120, 104, 90, 51, 116, 119, 90, 71, 90, 102, 97, 109,  70, 50, 89, 88, 78, 106, 99, 109, 108, 119, 100, 70, 57, 116,  89, 87, 100, 112, 89, 51, 48, 61];
app.alert(String.fromCharCode.apply(null, _d));
```

これをDevToolsのConsoleとかで実行すると更に次の出力が得られる。
```
Your flag is: ZmxhZ3twZGZfamF2YXNjcmlwdF9tYWdpY30=
```

Base64エンコードされているので、CyberChefでデコードするとフラグが得られた。

### `flag{pdf_javascript_magic}`